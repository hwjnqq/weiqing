{template 'common/header'}
<div class="right-contnt">
	<div class="we7-page-title">二维码管理</div>
	<ul class="we7-page-tab">
		<li><a href="{php echo url('platform/qr/list');}">二维码列表</a></li>
		<li class="active"><a href="{php echo url('platform/qr/display');}">二维码扫描统计</a></li>
	</ul>
	<div class="we7-padding-bottom clearfix">
		<form action="./index.php" method="get" role="form">
			<input type="hidden" name="c" value="platform">
			<input type="hidden" name="a" value="qr">
			<input type="hidden" name="do" value="display">
			<div class="we7-form">
				<div class="pull-left we7-margin-right">
					<label class="control-label">时间范围</label>
					<div class="form-controls">
						{php echo tpl_form_field_daterange('time', array('starttime'=>date('Y-m-d', $starttime),'endtime'=>date('Y-m-d', $endtime)));}
					</div>
				</div>
				<div class="pull-left">
					<label class="control-label">二维码名称</label>
					<div class="form-controls">
						<input type="text" name="keyword" value="{$_GPC['keyword']}" style="width:300px" class="form-control" placeholder="请输入场景名称">
						<button class="form-control-addon"><i class="fa fa-search"></i></button>
					</div>
				</div>
			</div>
		</form>
	</div>
	<!-- <div class="panel we7-panel">
		<div class="panel-heading">
			趋势图
		</div>
		<div class="panel-content">
			<canvas id="myChart" width="1200" height="300"></canvas>
		</div>
	</div> -->
	<div class="panel we7-panel">
		<div class="panel-heading">详细数据&nbsp;&nbsp;&nbsp;&nbsp;<span class="text-muted" style="color:red;">扫描次数：{$count}</span></div>
	</div>
	<table class="table we7-table">
		<col width="110px"/>
		<tr>
			<th>场景名称</th>
			<th>粉丝</th>
			<th>关注/扫描</th>
			<th>扫描时间</th>
		</tr>
		<tr>
			{loop $list $row}
			<td class="font-defalut">{$row['name']}</td>
			<td class="font-defalut">
				<a href="#" title="{$row['openid']}">
					{if $nickname[$row['openid']]['nickname']}
						{$nickname[$row['openid']]['nickname']}
					{else}
						{php echo cutstr($row['openid'], 15)}
					{/if}
				</a>
			</td>
			<td class="font-defalut">{$row['type']}</td>
			<td class="font-sm">{php echo date('Y-m-d H:i:s', $row[createtime]);}</td>
			{/loop}
		</tr>
	</table>
	{$pager}
</div>
<script>
// require(['chart', 'daterangepicker'], function(c) {
// 			var chart = null;
// 			var chartDatasets = null;
// 			var templates = {
// 				flow1: {
// 					label: '新关注人数',
// 					fillColor : "rgba(36,165,222,0.1)",
// 					strokeColor : "rgba(36,165,222,1)",
// 					pointColor : "rgba(36,165,222,1)",
// 					pointStrokeColor : "#fff",
// 					pointHighlightFill : "#fff",
// 					pointHighlightStroke : "rgba(36,165,222,1)",
// 				},
// 				flow2: {
// 					label: '取消关注人数',
// 					fillColor : "rgba(203,48,48,0.1)",
// 					strokeColor : "rgba(203,48,48,1)",
// 					pointColor : "rgba(203,48,48,1)",
// 					pointStrokeColor : "#fff",
// 					pointHighlightFill : "#fff",
// 					pointHighlightStroke : "rgba(203,48,48,1)",
// 				},
// 				flow3: {
// 					label: '净增人数',
// 					fillColor : "rgba(149,192,0,0.1)",
// 					strokeColor : "rgba(149,192,0,1)",
// 					pointColor : "rgba(149,192,0,1)",
// 					pointStrokeColor : "#fff",
// 					pointHighlightFill : "#fff",
// 					pointHighlightStroke : "rgba(149,192,0,1)",
// 				},
// 				flow4: {
// 					label: '累计人数',
// 					fillColor : "rgba(231,160,23,0.1)",
// 					strokeColor : "rgba(231,160,23,1)",
// 					pointColor : "rgba(231,160,23,1)",
// 					pointStrokeColor : "#fff",
// 					pointHighlightFill : "#fff",
// 					pointHighlightStroke : "rgba(231,160,23,1)",
// 				}
// 			};

// 			function refreshData() {
// 				if(!chart || !chartDatasets) {
// 					return;
// 				}
// 				var visables = [];
// 				var i = 0;
// 				$('.checkbox input[type="checkbox"]').each(function(){
// 					if($(this).attr('checked')) {
// 						visables.push(i);
// 					}
// 					i++;
// 				});
// 				var ds = [];
// 				$.each(visables, function(){
// 					var o = chartDatasets[this];
// 					ds.push(o);
// 				});
// 				chart.datasets = ds;
// 				chart.update();
// 			}

// 			var url = './index.php?c=account&a=summary&acid={$_W['acid']}&uniacid={$_W['uniacid']}&starttime={$starttime}&endtime={$endtime}#aaaa';
// 			$.post(url, function(data){
// 				var data = $.parseJSON(data);
// 				var datasets = data.datasets;
// 				if(!chart) {
// 					var label = data.label;
// 					var ds = $.extend(true, {}, templates);
// 					ds.flow1.data = datasets.new;
// 					ds.flow2.data = datasets.cancel;
// 					ds.flow3.data = datasets.increase;
// 					ds.flow4.data = datasets.cumulate;
// 					var lineChartData = {
// 						labels : label,
// 						datasets : [ds.flow1, ds.flow2, ds.flow3, ds.flow4]
// 					};

// 					var ctx = document.getElementById("myChart").getContext("2d");
// 					chart = new Chart(ctx).Line(lineChartData, {
// 						responsive: true
// 					});
// 					chartDatasets = $.extend(true, {}, chart.datasets);
// 				}
// 				refreshData();
// 			});	
// });	
</script>

{template 'common/footer'}