{template 'common/header'}
<ul class="nav nav-tabs">
	<li class="active"><a href="{php echo $this->createWeburl('roommanage', array('op' => 'display'))}">客房管理</a></li>
</ul>

<div class="main">
	<div class="panel panel-info">
		<div class="panel-heading">筛选</div>
		<div class="panel-body">
			<form action="./index.php" method="get" class="form-horizontal" role="form">
				<input type="hidden" name="c" value="site" />
				<input type="hidden" name="a" value="entry" />
				<input type="hidden" name="m" value="wn_storex_plugin_hotel_service" />
				<input type="hidden" name="do" value="roommanage" />
				<div class="form-group">
					<label class="col-xs-12 col-sm-2 col-md-2 col-lg-1 control-label">店铺</label>
					<div class="col-xs-12 col-sm-8 col-lg-9">
						<select name="storeid">
							<option value="-1">全部</option>
							{loop $hotel_lists $hotel}
							<option value="{$hotel['id']}">{$hotel['title']}</option>
							{/loop}
						</select>
					</div>
				</div>
				<div class="form-group">
					<div class=" col-xs-12 col-sm-2 col-lg-2">
						<button class="btn btn-default"><i class="fa fa-search"></i> 搜索</button>
					</div>
				</div>
			</form>
		</div>
	</div>
	<div class="clearfix" id="roommanage">
		<table class="table table-hover">
			<thead class="navbar-inner">
				<tr>
					<th>酒店信息</th>
					<th>预约信息</th>
					<th>操作</th>
				</tr>
			</thead>
			<tbody>
				{loop $room_items $item}
				<tr>
					<td width="230">
						<img src="{php echo tomedia($item['hotel_info']['thumb'])}" width="50px" height="50px">
						{$item['hotel_info']['title']}
					</td>
					<td style="text-align:left;">
						{$item['info']}
					</td>
					<td>
						<a href="" class="btn btn-danger">删除</a>
					</td>
				</tr>
				{/loop}
			</tbody>
		</table>
	</div>
</div>
<script type="text/javascript">
	require({
		paths: {
			'vue': 'https://unpkg.com/vue@2.2.6/dist/vue',
		}
	})
	var items = {php echo json_encode($item_list)} ? {php echo json_encode($item_list)} : [];
	console.dir(items)
	require(['vue'], function(Vue) {
		var app = new Vue({
			el: '#roommanage',
			data: {
				roomitem: items
			},
			methods: {
				addItem() {
					this.roomitem.push({
						'name': '',
						'max': 3,
					});
				},
				deleteItem(index) {
					this.roomitem.splice(index, 1);
				},
				telSubmit() {
					$.post("{php echo $this->createWeburl('roommanage', array('op' => 'post'));}", {params : this.roomitem}, function(data) {
						data = $.parseJSON(data);
						if (data.message.errno != 0) {
							util.message(data.message.message, '', 'error');
						} else {
							util.message('设置成功', data.redirect, 'success');
						}
					});
				}
			}
		});
	});
</script>
{template 'common/footer'}